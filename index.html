#include <ArduinoBLE.h>

BLEService pressureService("12345678-1234-1234-1234-123456789abc"); // custom service

BLEUnsignedCharCharacteristic sensor1Char("11111111-1234-1234-1234-123456789abc", BLERead | BLENotify);
BLEUnsignedCharCharacteristic sensor2Char("22222222-1234-1234-1234-123456789abc", BLERead | BLENotify);

void setup() {
  Serial.begin(9600);
  BLE.begin();
  BLE.setLocalName("FootGuard");  // Name used in Web Bluetooth filter
  BLE.setAdvertisedService(pressureService);

  pressureService.addCharacteristic(sensor1Char);
  pressureService.addCharacteristic(sensor2Char);
  BLE.addService(pressureService);

  sensor1Char.writeValue(0);
  sensor2Char.writeValue(0);

  BLE.advertise();
  Serial.println("BLE device active");
}

void loop() {
  BLEDevice central = BLE.central();

  if (central) {
    Serial.print("Connected to central: ");
    Serial.println(central.address());
    while (central.connected()) {
      int s1 = analogRead(A0) / 10; // convert 0-1023 to 0-100
      int s2 = analogRead(A1) / 10;
      sensor1Char.writeValue(s1);
      sensor2Char.writeValue(s2);
      delay(500);
    }
    Serial.println("Central disconnected");
  }
}
