<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FootGuard – Diabetes Foot Health Dashboard</title>

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
/* ===== Base Styles ===== */
* { margin:0; padding:0; box-sizing:border-box; font-family:'Roboto', sans-serif; }
body { background:#fafafb; color:#333; }
header { background:#1976d2; color:white; padding:25px 0; text-align:center; }
header h1 { font-size:2.8em; }
nav { display:flex; justify-content:center; background:#1565c0; flex-wrap:wrap; }
nav button { background:#1565c0; border:none; padding:15px 25px; color:white; cursor:pointer; font-size:16px; margin:3px; border-radius:5px; transition:0.3s; }
nav button.active, nav button:hover { background:#42a5f5; }
section { display:none; padding:40px 20px; max-width:1000px; margin:auto; }
section.active { display:block; }
h2 { color:#1565c0; margin-bottom:15px; }
p { margin-bottom:15px; line-height:1.6; }
.chart-container { width:100%; max-width:900px; height:400px; margin-top:20px; background:white; padding:20px; border-radius:15px; box-shadow:0 4px 10px rgba(0,0,0,0.1); }
.connect-btn { padding:12px 25px; font-size:16px; background:#1976d2; color:white; border:none; cursor:pointer; border-radius:5px; margin-top:10px; transition:0.3s; }
.connect-btn:hover { background:#0d47a1; }
.advice { background:#e3f2fd; padding:20px; margin-top:20px; border-left:5px solid #2196f3; border-radius:5px; }
.review-container { display:flex; flex-wrap:wrap; gap:20px; margin-top:20px; }
.review-card { background:white; flex:1 1 300px; padding:15px; border-radius:10px; box-shadow:0 2px 5px rgba(0,0,0,0.1); }
footer { text-align:center; padding:20px; background:#1565c0; color:white; margin-top:30px; font-size:0.9em; }
.info-box { background:#fff8e1; padding:15px; margin:10px 0; border-left:5px solid #ffb300; border-radius:5px; }
img { max-width:100%; height:auto; border-radius:10px; transition:transform 0.3s; }
img:hover { transform:scale(1.05); }
</style>
</head>
<body>

<header>
  <h1>FootGuard – Diabetes Foot Health Dashboard</h1>
  <p>Monitoring Plantar Pressure for Diabetic Foot Ulcer Prevention</p>
</header>

<nav>
  <button class="tab-btn active" data-target="landing">Home</button>
  <button class="tab-btn" data-target="research">Research & Abstract</button>
  <button class="tab-btn" data-target="pressure">Pressure Data</button>
  <button class="tab-btn" data-target="interpretation">Interpretation</button>
  <button class="tab-btn" data-target="reviews">Reviews</button>
</nav>

<!-- ===== Landing ===== -->
<section id="landing" class="active">
  <h2>Welcome to FootGuard</h2>
  <p>
    FootGuard is an interactive dashboard designed to visualize plantar pressure in patients with diabetes and interpret risk based on evidence‑based thresholds.
    People with diabetes are at higher risk of foot complications due to neuropathy and impaired circulation, leading to ulcers and potential amputations.
  </p>
  <p>
    Monitoring pressure distribution in the foot can help detect areas prone to injury so patients and clinicians can take preventive steps early.
  </p>
  <img src="https://images.unsplash.com/photo-1588776814546-4fda3e3bb2e6?auto=format&fit=crop&w=900&q=80" alt="Diabetic Foot Monitoring Image">
</section>

<!-- ===== Research & Abstract ===== -->
<section id="research">
  <h2>Abstract: Diabetes & Plantar Pressure Monitoring</h2>
  <p>
    Diabetic foot complications are among the leading causes of non‑traumatic lower limb amputations worldwide. Peripheral neuropathy and peripheral arterial disease reduce protective sensation and impair healing, respectively.
    Elevated plantar pressures are strongly associated with foot ulceration in people with diabetes, particularly when high pressure is sustained over time. Early detection of abnormal pressure patterns can significantly reduce ulcer risk and improve outcomes.
  </p>
  <div class="info-box">
    <strong>Key References:</strong>
    <ul>
      <li>Bus, S. A., et al. (2016). <em>International Working Group on the Diabetic Foot</em> Guidance on foot ulcers.</li>
      <li>Armstrong, D.G., et al. (1998). <em>Pressure redistribution and ulcer prevention</em>.</li>
      <li>Veves, A., et al. (1992). <em>Plantar pressure and ulcer risk</em>.</li>
    </ul>
  </div>
  <p>
    This dashboard incorporates statistical summaries of peak and mean pressures over clinically relevant time windows, aligning with research suggesting that persistent high pressures significantly increase ulceration risk.
  </p>
</section>

<!-- ===== Pressure Data ===== -->
<section id="pressure">
  <h2>Live Plantar Pressure Data</h2>
  <button class="connect-btn" onclick="connectBLE()">Connect to Arduino Nano 33 BLE</button>
  <div class="chart-container">
    <canvas id="pressureChart"></canvas>
  </div>
  <div class="info-box">
    <p>High peak pressures (90th percentile) and elevated mean pressures over time are correlated with increased risk of tissue breakdown in diabetes.</p>
  </div>
</section>

<!-- ===== Interpretation ===== -->
<section id="interpretation">
  <h2>Interpretation & Patient Advice</h2>
  <div id="adviceText" class="advice">
    <p>No data yet. Connect to the Arduino to begin receiving readings and professional advice.</p>
  </div>
  <div class="info-box">
    <p>
      Advice is based on analysis of recent pressure history, including mean and 90th percentile metrics, which have been linked to ulcer risk thresholds in clinical diabetic foot research.
    </p>
  </div>
</section>

<!-- ===== Reviews ===== -->
<section id="reviews">
  <h2>Testimonials & Professional Support</h2>
  <div class="review-container">
    <div class="review-card">
      <p><strong>Dr. Pandya, Podiatrist:</strong> “FootGuard presents pressure data in a clinically meaningful way. This could improve preventative care workflows.”</p>
    </div>
    <div class="review-card">
      <p><strong>Mr. Distasio, Diabetes Patient:</strong> “Knowing pressure levels in real time gives me confidence. I check my feet weekly now.”</p>
    </div>
  </div>
</section>

<footer>
  <p>© 2026 FootGuard • Powered by Arduino, Chart.js & Evidence‑Based Practice</p>
</footer>

<script>
// ===== Tab Navigation =====
const tabs = document.querySelectorAll('.tab-btn');
const sections = document.querySelectorAll('section');
tabs.forEach(tab => {
  tab.addEventListener('click', () => {
    tabs.forEach(t => t.classList.remove('active'));
    tab.classList.add('active');
    sections.forEach(sec => sec.classList.remove('active'));
    document.getElementById(tab.dataset.target).classList.add('active');
  });
});

// ===== Chart.js Setup =====
const ctx = document.getElementById('pressureChart').getContext('2d');
const pressureChart = new Chart(ctx, {
  type:'line',
  data:{
    labels:[],
    datasets:[
      { label:'Sensor 1', borderColor:'rgba(75,192,192,1)', backgroundColor:'rgba(75,192,192,0.2)', data:[], tension:0.3 },
      { label:'Sensor 2', borderColor:'rgba(255,99,132,1)', backgroundColor:'rgba(255,99,132,0.2)', data:[], tension:0.3 }
    ]
  },
  options:{
    responsive:true,
    animation:false,
    scales:{ y:{min:0,max:100, title:{ display:true, text:'Pressure (%)'}}, x:{ title:{display:true, text:'Time'}} }
  }
});

// ===== History & Stats =====
let pressureHistory = [];
const historyLimit = 60;
let simulatedInterval;
let bleConnected = false;

// ===== Simulated Data =====
function startSimulatedData(){
  simulatedInterval = setInterval(()=>{
    if(!bleConnected){
      const s1 = Math.floor(Math.random()*100);
      const s2 = Math.floor(Math.random()*100);
      addDataToChart(s1,s2);
    }
  }, 500);
}
startSimulatedData();

// ===== Add Data =====
function addDataToChart(sensor1,sensor2){
  const now = new Date().toLocaleTimeString();
  pressureChart.data.labels.push(now);
  pressureChart.data.datasets[0].data.push(sensor1);
  pressureChart.data.datasets[1].data.push(sensor2);
  if(pressureChart.data.labels.length > 50){
    pressureChart.data.labels.shift();
    pressureChart.data.datasets.forEach(ds => ds.data.shift());
  }
  pressureChart.update('none');

  // Track average pressure history
  pressureHistory.push((sensor1 + sensor2) / 2);
  if(pressureHistory.length > historyLimit) pressureHistory.shift();
}

// ===== Compute Statistics =====
function computeStats(history){
  if(history.length===0) return null;
  const sorted = [...history].sort((a,b)=>a-b);
  const sum = history.reduce((a,b)=>a+b,0);
  const mean = sum/history.length;
  const p90 = sorted[Math.floor(0.9 * sorted.length)];
  const max = Math.max(...sorted);
  return { mean, p90, max };
}

// ===== Generate Advice (Diabetes Focused) =====
function generateAdvice(stats){
  if(!stats) return {risk:"Awaiting data","advice":"Waiting for initial readings..."};
  let risk, advice;
  if(stats.mean < 50 && stats.p90 < 60){
    risk = "Low Risk";
    advice = `
      Average pressure is relatively low (${stats.mean.toFixed(1)}%). Research suggests that plantar pressures 
      below these levels are associated with lower ulcer risk when combined with regular foot inspection and good footwear.
    `;
  } else if((stats.mean>=50 && stats.mean<=70) || (stats.p90>=60 && stats.p90<=75)){
    risk = "Moderate Risk";
    advice = `
      Moderate pressures detected (mean ${stats.mean.toFixed(1)}%, 90th percentile ${stats.p90.toFixed(1)}%). 
      Literature indicates that pressures in this range can predispose to skin trauma—consider gait assessment, cushioned footwear, and activity modification.
    `;
  } else {
    risk = "High Risk";
    advice = `
      Elevated pressures (mean ${stats.mean.toFixed(1)}%, 90th percentile ${stats.p90.toFixed(1)}) are correlated with higher risk of ulcer formation 
      in individuals with diabetes. Immediate steps: ensure offloading footwear, reduce weight bearing, monitor skin, and consult a clinician.
    `;
  }
  return { risk, advice };
}

// ===== Update Advice Periodically =====
setInterval(()=>{
  const stats = computeStats(pressureHistory);
  const {risk,advice} = generateAdvice(stats);
  document.getElementById("adviceText").innerHTML = `<h3>${risk}</h3><p>${advice}</p>`;
},30000);

// ===== BLE Connection =====
async function connectBLE(){
  try{
    const device = await navigator.bluetooth.requestDevice({filters:[{name:'PlantarPressure'}], optionalServices:['12345678-1234-1234-1234-123456789abc']});
    const server = await device.gatt.connect();
    const service = await server.getPrimaryService('12345678-1234-1234-1234-123456789abc');
    const s1Char = await service.getCharacteristic('11111111-1234-1234-1234-123456789abc');
    const s2Char = await service.getCharacteristic('22222222-1234-1234-1234-123456789abc');

    clearInterval(simulatedInterval);
    bleConnected = true;
    alert("BLE Connected — using real sensor data!");

    await s1Char.startNotifications();
    await s2Char.startNotifications();
    s1Char.addEventListener('characteristicvaluechanged', e => addDataToChart(e.target.value.getUint8(0), pressureChart.data.datasets[1].data.slice(-1)[0]||0));
    s2Char.addEventListener('characteristicvaluechanged', e => addDataToChart(pressureChart.data.datasets[0].data.slice(-1)[0]||0, e.target.value.getUint8(0));

  } catch(err){
    alert("BLE connection failed: "+err);
  }
}
</script>

</body>
</html>
